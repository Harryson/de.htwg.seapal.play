{
   "_id": "_design/Waypoint",
   "_rev": "1-2701ece0bb780e1d81eb5ac2a6e3cbeb",
   "language": "coffeescript",
   "views": {
    "waypointAsJson": {
     "map": "(doc)->\n if doc?\n  if doc.owner? && doc.owner.length? && doc.owner.length > 0\n   emit \"#{doc.owner}#{doc._id}\", doc\n  if doc.crew? && doc.crew.length? && doc.crew.length > 0\n   for crew_member of doc.crew\n    emit \"#{crew_member}#{doc._id}\", doc\n"
    },
    "waypointsAsJson": {
     "map": "(doc)->\n if doc?\n  if doc.owner? && doc.owner.length? && doc.owner.length > 0\n   emit \"#{doc.owner}#{doc.trip}\", doc\n  if doc.crew? && doc.crew.length? && doc.crew.length > 0\n   for crew_member of doc.crew\n    emit \"#{crew_member}#{doc.trip}\", doc\n"
    }
   },
   "validate_doc_update": "(newDoc, oldDoc, userCtx) ->\n if oldDoc? and !newDoc._deleted? and newDoc.owner isnt oldDoc.owner\n  throw forbidden: 'old and new user dont match'"
}
